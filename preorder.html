<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Glow On · 精選預購</title>
  <link rel="stylesheet" href="styles.css"/>
  <style>
    /* Header */
    .site-header .top { display:flex; align-items:center; justify-content:space-between; }
    .site-header .left { display:flex; align-items:center; gap:14px; }
    .site-header .logo strong { display:none; }
    .site-header .logo img { height:26px; width:auto; display:block; }
    .site-header .nav { display:flex; gap:14px; flex-wrap:wrap; }
    .site-header .nav a { text-decoration:none; }

    /* Banner */
    .banner img{ width:100%; height:320px; object-fit:cover; border-radius:12px; display:block; }
    @media (max-width:600px){ .banner img{ height:220px; } }

    /* Footer */
    .foot-row.en { display:none; }

    /* 商品卡片 */
    .card { display:block; border:1px solid #eee; border-radius:10px; overflow:hidden; text-decoration:none; color:inherit; }
    .card .thumb img { width:100%; display:block; }
    .card .content { padding:8px; }
    .card .title { font-weight:700; margin-bottom:4px; font-size:16px; }
    .card .price { font-weight:800; color:#b91c1c; font-size:16px; }
    .grid { display:grid; grid-template-columns:repeat(4,1fr); gap:16px; }
    @media (max-width:920px){ .grid{ grid-template-columns:repeat(2,1fr); } }
  </style>
</head>
<body data-page="preorder">
  <!-- Header -->
  <header class="site-header">
    <div class="container">
      <nav class="top">
        <div class="left">
          <a href="index.html" class="logo">
            <img src="Archive/logo.png" alt="Glow On logo">
            <strong data-i18n="brand">Glow On</strong>
          </a>
          <div class="nav">
            <a href="index.html" data-i18n="nav_home">首頁</a>
            <a href="preorder.html" data-route="preorder" data-i18n="nav_preorder">精選預購</a>
            <a href="instock.html"  data-route="instock"  data-i18n="nav_instock">現貨專區</a>
            <a href="buyagent.html" data-route="service"  data-i18n="nav_service">澳洲代購服務</a>
          </div>
        </div>

        <div class="actions">
          <a class="btn icon whatsapp" href="https://wa.me/85297436663" target="_blank" rel="noopener" title="WhatsApp" aria-label="WhatsApp">
            <img src="Archive/whats.png" alt="WhatsApp" style="height:24px;width:24px;">
          </a>
          <!-- 搜索改为跳转 search.html -->
          <a class="btn icon search" href="search.html" title="Search" aria-label="Search">🔍</a>
          <!-- 移除會員登入按鈕 -->
          <a class="btn icon cart"   href="checkout.html" title="Cart" aria-label="Cart">🛒</a>

          <div class="lang">
            <button id="langBtn" class="lang-btn" type="button" aria-haspopup="menu" aria-expanded="false">
              <span aria-hidden="true">🌐</span>
              <span id="langLabel">繁體中文</span>
              <span class="caret" aria-hidden="true">▾</span>
            </button>
            <div class="lang-menu" id="langMenu" role="menu" hidden>
              <button role="menuitem" data-lc="zh-HK">繁體中文</button>
              <button role="menuitem" data-lc="en">English</button>
            </div>
          </div>

          <button class="btn icon" id="moreBtn" aria-haspopup="menu" aria-expanded="false" title="更多">⋯</button>
          <div class="more-menu" id="moreMenu" hidden>
            <a class="item" href="https://wa.me/85297436663" target="_blank" rel="noopener">
              <img src="Archive/whats.png" alt="WhatsApp" style="height:18px;width:18px;vertical-align:middle;"> WhatsApp
            </a>
            <a class="item" href="search.html" id="moreSearch">🔍 Search</a>
            <!-- 移除 Login -->
            <a class="item" href="checkout.html">🛒 Cart</a>
            <div class="sep"></div>
            <button class="item" type="button" data-set-lc="zh-HK">繁體中文</button>
            <button class="item" type="button" data-set-lc="en">English</button>
          </div>
        </div>
      </nav>
    </div>
  </header>

  <main>
    <div class="container">
      <section class="banner" aria-label="Pre-Order">
        <img src="Archive/Promo_Banner/2.png" alt="Pre-Order Banner">
      </section>

      <section>
        <h1 class="sec-title" data-i18n="section_preorder">精選預購</h1>
        <div class="grid" id="preorder-grid"></div>
      </section>
    </div>
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="container footer-box">
      <nav class="foot-row zh">
        <a href="terms.html"><b>條款及細則</b></a>
        <a href="privacy.html"><b>私隱政策</b></a>
        <a href="returns.html"><b>退換貨政策</b></a>
        <a href="process.html"><b>購買流程</b></a>
        <a href="payment.html"><b>付款方式</b></a>
        <a href="contact.html"><b>聯絡我們</b></a>
      </nav>
      <nav class="foot-row en">
        <a href="terms.html"><b>Terms &amp; Conditions</b></a>
        <a href="privacy.html"><b>Privacy Policy</b></a>
        <a href="returns.html"><b>Return &amp; Exchange Policy</b></a>
        <a href="process.html"><b>Shopping Process</b></a>
        <a href="payment.html"><b>Payment Methods</b></a>
        <a href="contact.html"><b>Contact Us</b></a>
      </nav>
      <div class="copy">2025 © Glow On HK. <span data-i18n="rights">All Rights Reserved.</span></div>
    </div>
  </footer>

  <script src="site.js"></script>
  <script>
    // 每次上线改版本号
    const DATA_VERSION = '2025-10-18-01';

    function currentLocale(){
      try {
        if (typeof getLocale === 'function') {
          const lc = getLocale();
          if (lc === 'en' || lc === 'zh-HK') return lc;
        }
      } catch(e){}
      const docLang = (document.documentElement.lang || '').toLowerCase();
      if (docLang.startsWith('en')) return 'en';
      return 'zh-HK';
    }

    async function loadProductsOnce() {
      if (window.__PRODUCTS_LOADED__) return;
      const res = await fetch('/products.json?v=' + DATA_VERSION, { cache: 'no-store' });
      if (!res.ok) {
        console.error('Failed to load products.json', res.status, res.statusText);
        throw new Error('Failed to load products.json: ' + res.status);
      }
      const data = await res.json();
      window.__PRODUCTS_VERSION__ = data.version || DATA_VERSION;
      window.__PRODUCTS__ = data.items || data;
      window.__PRODUCTS_LOADED__ = true;
    }

    function renderPreorder() {
      if (typeof renderCardsInto !== 'function') {
        console.warn('renderCardsInto 未定义：请确认 site.js 是否正确加载。');
        return;
      }
      const run = () => renderCardsInto('#preorder-grid', p => String(p.category).toLowerCase() === 'preorder');
      if (window.__PRODUCTS_LOADED__) return run();
      loadProductsOnce().then(run).catch(console.error);
    }

    /* 兜底：切英文时把“首頁”改成“Homepage” */
    function updateHomeLabel(){
      if (currentLocale() === 'en') {
        document.querySelectorAll('[data-i18n="nav_home"]').forEach(el => el.textContent = 'Homepage');
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      renderPreorder();
      updateHomeLabel();
    });
    window.addEventListener('locale-changed', () => {
      renderPreorder();
      updateHomeLabel();
    });
  </script>
</body>
</html>