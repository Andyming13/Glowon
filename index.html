<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Glow On Â· Home</title>
  <link rel="stylesheet" href="styles.css"/>
  <style>
    /* â€”â€” ä»…æœ¬é¡µç”¨åˆ°çš„å°æ ·å¼ â€”â€” */

    /* å¤´éƒ¨ï¼šæŠŠ LOGO ä¸å¯¼èˆªæ”¾åˆ°å·¦ä¾§ä¸€è¡Œ */
    .site-header .top { display:flex; align-items:center; justify-content:space-between; }
    .site-header .left { display:flex; align-items:center; gap:14px; }
    .site-header .logo strong { display:none; } /* åªä¿ç•™å›¾æ ‡ */
    .site-header .logo img { height:26px; width:auto; display:block; }
    .site-header .nav { display:flex; gap:14px; flex-wrap:wrap; }
    .site-header .nav a { text-decoration:none; }

    /* è½®æ’­ Bannerï¼ˆå°ºå¯¸å·²ç¼©å°ï¼‰ */
    .banner.carousel { position:relative; overflow:hidden; border-radius:12px; margin:10px 0; }
    .banner.carousel .track { display:flex; width:100%; transition:transform .5s ease; }
    .banner.carousel .slide { flex:0 0 100%; }
    .banner.carousel img { width:100%; height:240px; object-fit:cover; display:block; cursor:pointer; border-radius:10px; }
    .banner.carousel .ctrl {
      position:absolute; inset:auto 8px 8px 8px; display:flex; gap:6px; justify-content:center;
    }
    .banner.carousel .dot {
      width:6px; height:6px; border-radius:999px; border:1px solid #111; background:#fff; opacity:.7;
    }
    .banner.carousel .dot[aria-current="true"] { background:#111; opacity:1; }

    @media (max-width:600px){
      .banner.carousel img { height:180px; }
    }

    /* é¡µè„šï¼šé»˜è®¤åªæ˜¾ç¤ºä¸­æ–‡è¡Œï¼Œè‹±æ–‡è¡Œåœ¨åˆ‡è‹±æ–‡æ—¶ç”±è„šæœ¬åˆ‡æ¢ */
    .foot-row.en { display:none; }

    /* å•†å“å¡ç‰‡ */
    .card { display:block; border:1px solid #eee; border-radius:10px; overflow:hidden; text-decoration:none; color:inherit; }
    .card .thumb img { width:100%; display:block; }
    .card .content { padding:8px; }
    .card .title { font-weight:600; margin-bottom:4px; font-size:14px; }
    .card .price { font-weight:700; color:#b91c1c; font-size:14px; }
  </style>
</head>
<body data-page="home">
  <!-- Header -->
  <header class="site-header">
    <div class="container">
      <nav class="top">
        <!-- å·¦ï¼šLOGO + å¯¼èˆªï¼ˆå·²ç§»åˆ°å·¦ä¾§ï¼‰ -->
        <div class="left">
          <a href="index.html" class="logo">
            <img src="Archive/logo.png" alt="Glow On logo">
            <strong data-i18n="brand">Glow On</strong><!-- å·²éšè— -->
          </a>
          <div class="nav">
            <a href="index.html" data-i18n="nav_home">é¦–é </a>
            <a href="preorder.html" data-route="preorder" data-i18n="nav_preorder">ç²¾é¸é è³¼</a>
            <a href="instock.html"  data-route="instock"  data-i18n="nav_instock">ç¾è²¨å°ˆå€</a>
            <a href="buyagent.html" data-route="service"  data-i18n="nav_service">æ¾³æ´²ä»£è³¼æœå‹™</a>
          </div>
        </div>

        <!-- å³ï¼šåŠ¨ä½œ + è¯­è¨€ -->
        <div class="actions">
          <a class="btn icon whatsapp" 
             href="https://wa.me/85297436663" 
             target="_blank" 
             rel="noopener" 
             title="WhatsApp" 
             aria-label="WhatsApp">
            <img src="Archive/whats.png" alt="WhatsApp" style="height:24px;width:24px;">
          </a>
          <a class="btn icon search" href="#" title="Search" aria-label="Search">ğŸ”</a>
          <a class="btn icon login"  href="login.html" title="Login" aria-label="Login">ğŸ‘¤</a>
          <a class="btn icon cart"   href="checkout.html" title="Cart" aria-label="Cart">ğŸ›’</a>

          <!-- è¯­è¨€åˆ‡æ¢ -->
          <div class="lang">
            <button id="langBtn" class="lang-btn" type="button" aria-haspopup="menu" aria-expanded="false">
              <span aria-hidden="true">ğŸŒ</span>
              <span id="langLabel">ç¹é«”ä¸­æ–‡</span>
              <span class="caret" aria-hidden="true">â–¾</span>
            </button>
            <div class="lang-menu" id="langMenu" role="menu" hidden>
              <button role="menuitem" data-lc="zh-HK">ç¹é«”ä¸­æ–‡</button>
              <button role="menuitem" data-lc="en">English</button>
            </div>
          </div>

          <!-- æ›´å¤šæŒ‰é’®ï¼ˆæ‰‹æœºç«¯ï¼‰ -->
          <button class="btn icon" id="moreBtn" aria-haspopup="menu" aria-expanded="false" title="æ›´å¤š">â‹¯</button>
          <div class="more-menu" id="moreMenu" hidden>
            <a class="item" href="https://wa.me/85297436663" target="_blank" rel="noopener">
              <img src="Archive/whats.png" alt="WhatsApp" style="height:18px;width:18px;vertical-align:middle;"> WhatsApp
            </a>
            <a class="item" href="#" id="moreSearch">ğŸ” Search</a>
            <a class="item" href="login.html">ğŸ‘¤ Login</a>
            <a class="item" href="checkout.html">ğŸ›’ Cart</a>
            <div class="sep"></div>
            <button class="item" type="button" data-set-lc="zh-HK">ç¹é«”ä¸­æ–‡</button>
            <button class="item" type="button" data-set-lc="en">English</button>
          </div>
        </div>
      </nav>
    </div>
  </header>

  <main class="home">
    <div class="container">

      <!-- Bannerï¼šæŒ‰è¯­è¨€åŠ¨æ€æ¸²æŸ“ä¸‰å¼ ï¼ˆ1ã€5/6ã€7/8ï¼‰ -->
      <section class="banner carousel" aria-label="Promotions">
        <div class="track" id="carouselTrack"></div>
        <div class="ctrl" id="carouselDots" aria-label="Carousel Dots"></div>
      </section>

      <!-- ç²¾é¸é è³¼ -->
      <section>
        <div style="display:flex;align-items:center;justify-content:space-between">
          <h2 class="sec-title" data-i18n="section_preorder">ç²¾é¸é è³¼</h2>
          <a href="preorder.html" data-route="preorder"><span data-i18n="view_all">æŸ¥çœ‹å…¨éƒ¨</span> â†’</a>
        </div>
        <div class="grid" id="home-preorder"></div>
      </section>

      <!-- ç¾è²¨å¥½ç‰© -->
      <section>
        <div style="display:flex;align-items:center;justify-content:space-between">
          <h2 class="sec-title" data-i18n="section_instock">ç¾è²¨å¥½ç‰©</h2>
          <a href="instock.html" data-route="instock"><span data-i18n="view_all">æŸ¥çœ‹å…¨éƒ¨</span> â†’</a>
        </div>
        <div class="grid" id="home-instock"></div>
      </section>

    </div>
  </main>

  <!-- Footerï¼ˆæ–°å¢â€œä»˜æ¬¾æ–¹å¼/Payment Methodsâ€ï¼‰ -->
  <footer class="site-footer">
    <div class="container footer-box">
      <nav class="foot-row zh">
        <a href="terms.html"><b>æ¢æ¬¾åŠç´°å‰‡</b></a>
        <a href="privacy.html"><b>ç§éš±æ”¿ç­–</b></a>
        <a href="returns.html"><b>é€€æ›è²¨æ”¿ç­–</b></a>
        <a href="process.html"><b>è³¼è²·æµç¨‹</b></a>
        <a href="payment.html"><b>ä»˜æ¬¾æ–¹å¼</b></a>
        <a href="contact.html"><b>è¯çµ¡æˆ‘å€‘</b></a>
      </nav>
      <nav class="foot-row en">
        <a href="terms.html"><b>Terms &amp; Conditions</b></a>
        <a href="privacy.html"><b>Privacy Policy</b></a>
        <a href="returns.html"><b>Return &amp; Exchange Policy</b></a>
        <a href="process.html"><b>Shopping Process</b></a>
        <a href="payment.html"><b>Payment Methods</b></a>
        <a href="contact.html"><b>Contact Us</b></a>
      </nav>
      <div class="copy">2025 Â© Glow On HK. <span data-i18n="rights">All Rights Reserved.</span></div>
    </div>
  </footer>

  <!-- ä½ çš„ç«™ç‚¹å…¬å…±é€»è¾‘ï¼ˆå« renderCardsInto / è¯­è¨€åˆ‡æ¢ç­‰ï¼‰ -->
  <script src="site.js"></script>

  <!-- æœ¬é¡µè„šæœ¬ï¼šå¸¦ç‰ˆæœ¬å·åŠ è½½ products.json + è½®æ’­ + é¦–é¡µæ¸²æŸ“ -->
  <script>
    /* === é…ç½®ï¼šæ¯æ¬¡å‘å¸ƒæ”¹ä¸€æ¬¡ç‰ˆæœ¬å·ï¼ˆå»ºè®®ç”¨å½“æ—¥æˆ–æœ€æ–° commit SHAï¼‰ === */
    const DATA_VERSION = '2025-10-18-01';

    /* === å®ç”¨ï¼šå®‰å…¨è·å–å½“å‰è¯­è¨€ï¼Œè‹¥æ—  getLocale åˆ™å›é€€åˆ° <html lang> === */
    function currentLocale(){
      try {
        if (typeof getLocale === 'function') {
          const lc = getLocale();
          if (lc === 'en' || lc === 'zh-HK') return lc;
        }
      } catch(e) {}
      const docLang = (document.documentElement.lang || '').toLowerCase();
      if (docLang.startsWith('en')) return 'en';
      return 'zh-HK';
    }

    /* === ä»…åŠ è½½ä¸€æ¬¡äº§å“æ•°æ®ï¼Œå¹¶æ³¨å…¥å…¨å±€ === */
    async function loadProductsOnce(){
      if (window.__PRODUCTS_LOADED__) return;
      const res = await fetch('/products.json?v=' + DATA_VERSION, { cache: 'no-store' });
      if (!res.ok) throw new Error('Failed to load products.json: ' + res.status);
      const data = await res.json();
      window.__PRODUCTS_VERSION__ = data.version || DATA_VERSION;
      window.__PRODUCTS__ = Array.isArray(data) ? data : (data.items || []);
      window.__PRODUCTS_LOADED__ = true;
    }

    /* === è½®æ’­ï¼ˆæŒ‰è¯­è¨€é€‰æ‹©ä¸åŒå›¾ç‰‡ï¼‰ === */
    function buildPromoSlides(){
      const lc = currentLocale();
      const track = document.getElementById('carouselTrack');
      const dotsWrap = document.getElementById('carouselDots');
      if (!track || !dotsWrap) return;

      const slides = [
        { src: 'Archive/Promo_Banner/1.png', link: 'preorder.html', clickable: true, alt: 'Promo 1' },
        { src: lc === 'en' ? 'Archive/Promo_Banner/6.png' : 'Archive/Promo_Banner/5.png', clickable: false, alt: lc === 'en' ? 'Promo 6' : 'Promo 5' },
        { src: lc === 'en' ? 'Archive/Promo_Banner/8.png' : 'Archive/Promo_Banner/7.png', clickable: false, alt: lc === 'en' ? 'Promo 8' : 'Promo 7' }
      ];

      track.innerHTML = slides.map(s => {
        const img = `<img src="${s.src}" alt="${s.alt}">`;
        return `<div class="slide">${ s.clickable ? `<a href="${s.link}">${img}</a>` : img }</div>`;
      }).join('');

      dotsWrap.innerHTML = '';
      for (let i = 0; i < slides.length; i++){
        const d = document.createElement('button');
        d.className = 'dot';
        d.type = 'button';
        d.setAttribute('aria-label', 'go to slide ' + (i + 1));
        d.addEventListener('click', () => carouselGo(i, true));
        dotsWrap.appendChild(d);
      }

      window.__carousel__ = { idx: 0, total: slides.length, timer: null, track, dotsWrap };
      carouselRender();
      carouselAuto(true);

      track.parentElement.addEventListener('mouseenter', () => carouselAuto(false));
      track.parentElement.addEventListener('mouseleave', () => carouselAuto(true));
    }

    function carouselRender(){
      const c = window.__carousel__;
      if (!c) return;
      c.track.style.transform = `translateX(-${c.idx * 100}%)`;
      [...c.dotsWrap.children].forEach((el, i) => el.setAttribute('aria-current', i === c.idx ? 'true' : 'false'));
    }
    function carouselGo(i, stop){
      const c = window.__carousel__;
      if (!c) return;
      c.idx = (i + c.total) % c.total;
      carouselRender();
      if (stop){ carouselAuto(false); }
    }
    function carouselAuto(start = true){
      const c = window.__carousel__;
      if (!c) return;
      if (c.timer){ clearInterval(c.timer); c.timer = null; }
      if (start){ c.timer = setInterval(() => carouselGo(c.idx + 1, false), 3500); }
    }

    /* === é¦–é¡µå•†å“æ¸²æŸ“ï¼ˆç¡®ä¿å…ˆåŠ è½½æ•°æ®ï¼‰ === */
    function renderHomeFromJSON(){
      if (typeof renderCardsInto !== 'function') {
        console.warn('renderCardsInto æœªå®šä¹‰ï¼Œè¯·æ£€æŸ¥ site.js æ˜¯å¦æ­£ç¡®åŠ è½½');
        return;
      }
      renderCardsInto('#home-preorder', p => String(p.category).toLowerCase() === 'preorder');
      renderCardsInto('#home-instock',  p => String(p.category).toLowerCase() === 'instock');
    }

    function ensureDataThen(fn){
      if (window.__PRODUCTS_LOADED__) return fn();
      loadProductsOnce().then(fn).catch(err => console.error(err));
    }

    /* === åˆå§‹åŒ– === */
    document.addEventListener('DOMContentLoaded', () => {
      buildPromoSlides();
      ensureDataThen(renderHomeFromJSON);
    });

    /* === è¯­è¨€åˆ‡æ¢ï¼šé‡å»ºè½®æ’­ + é‡æ–°æ¸²æŸ“é¦–é¡µå•†å“ === */
    window.addEventListener('locale-changed', () => {
      if (window.__carousel__ && window.__carousel__.timer){
        clearInterval(window.__carousel__.timer);
        window.__carousel__.timer = null;
      }
      buildPromoSlides();
      ensureDataThen(renderHomeFromJSON);
    });
  </script>
</body>
</html>